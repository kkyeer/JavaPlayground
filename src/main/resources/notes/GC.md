# 各种GC收集器

## 策略

1. 标记-清扫
2. 标记-复制
3. 标记-整理:先清扫，再向一端移动

## Serial/SerialOld（PS MarkSweep）

单线程，STW高，新生代Serial复制算法，老生代SerialOld采用标记-整理

## ParNew

Serial的多线程版本，标记-复制算法，唯一能与CMS收集器配合的新生代收集器

## Parallel Scavenge

与ParNew思路一致，但可以选择停顿时间少优先或者吞吐量高优先的两种调优策略，以及带有自适应参数调节

## Parallel Old

与Parallel New搭配，可以进行新生代+老生代整体调优

## CMS

老年代收集器，只能与ParNew配合，将GC分为4步：

1. 初始标记：STW,遍历GC Root集合直接关联的对象
2. 并发标记：与用户线程并发执行，标记所有第一步结果关联的对象
3. 重新标记：STW,重新标记未整理的对象（采用灰白算法）
4. 并发清除：与用户线程并发执行，清理标记GC的内存

优点：耗时高的并发标记和并发清除与用户线程并发，STW时间大大缩短
缺点：

1. 低性能主机，GC占用大，使用线程数为(核数量+3)/4，对于6核CPU，使用2个线程，消耗大
2. 浮动垃圾无法收集，有部分垃圾会被漏标记，如果在CMS线程运行期间老生代膨胀过快，则会出发"并发清除失败",触发一次Full GC
3. 并发清除不整理会在老生代遗留较多内存碎片，碎片积累到一定程度则无法分配大对象，也会提前触发Full GC

## 